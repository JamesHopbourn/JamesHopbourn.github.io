<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="css/index.css" type="text/css" />
  <script src="https://cdn.staticfile.org/jquery/3.6.0/jquery.js"></script>
  <script src="https://cdn.staticfile.org/html2canvas/0.5.0-beta4/html2canvas.js"></script>
</head>

<body>
  <div id="title">2022 特跑族全国 10K 排位赛成绩</div>

  <div id="button-pref">
    <button onclick="setData('data/overall.json', '全体排名')">全体排名</button>
    <button onclick="setData('data/man.json', '男子排名')">男子排名</button>
    <button onclick="setData('data/woman.json', '女子排名')">女子排名</button>
  </div>

  <table>
    <tr>
    </tr>
  </table>
  <script>
    window.onload = () => {
      $('title').text('成绩查询');
      setData('data/overall.json', '全体排名');
    }

    setData = (url, type) => {
      $.getJSON(url, result => {
        medal = {1: "🏅️", 2: "🥈", 3: "🥉"};
        text = ['<tr>', `<td colspan="6">${type}</td>`, '</tr>', '<tr>', `<th>排名</th>`, '<th>号码</th>',
            '<th>名字</th>', '<th>性别</th>', '<th>计时时间</th>', '<th>配速</th>', '</tr>'];
        for (let index = 0; index < result.length; index++) {
          data = result[index];
          text.push('<tr>');
          text.push(`<td>${medal[data['rank']] || `${data['rank']}`}</td>`);
          text.push(`<td>${data['bib_no']}</td>`);
          text.push(`<td><a href="./certificate.html?type=${url}&index=${index}">${data['name']}</a></td>`);
          text.push(`<td>${data['gender']}</td>`);
          text.push(`<td>${data['time']}</td>`);
          text.push(`<td>${data['pace']}</td>`);
          text.push('</tr>');
        }
        $('tbody').empty().append(text.join('\n'));
      })
    }
  </script>
</body>

</html>