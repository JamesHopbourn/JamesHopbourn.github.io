<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="css/index.css" type="text/css" />
  <script src="https://cdn.staticfile.org/jquery/3.6.0/jquery.js"></script>
</head>

<body>
  <div id="title">2022 特跑族全国 10K 排位赛成绩</div>

  <div id="button-pref">
    <button onclick="setData(0)">全体排名</button>
    <button onclick="setData(1)">男子组排名</button>
    <button onclick="setData(2)">女子组排名</button>
  </div>

  <table>
    <tr>
    </tr>
  </table>
  <div class="footer-img"><img src="images/xetp.png"></div>
  <script>
    window.onload = () => {
      $('title').text('成绩查询');
      setData(sessionStorage.getItem('group') || 0);
    }

    setData = (group) => {
      sessionStorage.setItem('group', group);
      header = ["全体排名", "男子组排名", "女子组排名"];
      $.getJSON(`data/${["overall", "man", "woman"][group]}.json`, data => {
        text = ['<tr>', `<td colspan="6" class="head">${header[group]}</td>`, '</tr>',
          '<tr>',
            '<td colspan="3" class="head">地点：木兰溪</br>日期：2022/06/19</td>',
            '<td colspan="3" class="head">圈数：一圈</br>距离：10 公里</td>',
          '</tr>',
          '<tr>', `<th>排名</th>`, '<th>号码</th>','<th>名字</th>', 
          '<th>性别</th>', '<th>计时时间</th>', '<th>配速</th>','</tr>'
        ];
        for (let index = 0; index < data.length; index++) {
          text.push('<tr>');
          text.push(`<td>${data[index]['rank']}</td>`);
          text.push(`<td>${data[index]['bib_no']}</td>`);
          link = window.btoa(`${group},${index}`).replace(/=/g, '');
          text.push(`<td><a href="./cert.html?${link}">${data[index]['name']}</a></td>`);
          text.push(`<td>${data[index]['gender']}</td>`);
          text.push(`<td>${data[index]['time']}</td>`);
          text.push(`<td>${data[index]['pace']}</td>`);
          text.push('</tr>');
        }
        $('tbody').empty().append(text.join('\n'));
      });
    }
  </script>
</body>

</html>